import{g as R,m as X,d as D,D as s,r as o,C as N,c as b,n as M,N as V,t as K,W as Q,j as c,T as G,bJ as F,B as Y}from"./index-l461O1zk.js";import{l as B,B as J,S as U}from"./PageWrapper-sLkUscXw.js";import{g as Z,c as k}from"./get-VWd4L7mn.js";import{C as ee}from"./ContentWrapper-JLFWJM2O.js";import{u as H}from"./useQuery-9DgONkgY.js";import{S as te}from"./date-WJIA4S6h.js";import{d as ie}from"./dayjs.min-3Z0krTT9.js";import{R as re}from"./ReloadOutlined-XyfkVv_8.js";import"./key-name-frYyCvOB.js";const ae=e=>{const{componentCls:t,calc:r}=e;return{[t]:Object.assign(Object.assign({},D(e)),{margin:0,padding:0,listStyle:"none",[`${t}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:r(r(e.itemHeadSize).sub(e.tailWidth)).div(2).equal(),height:`calc(100% - ${s(e.itemHeadSize)})`,borderInlineStart:`${s(e.tailWidth)} ${e.lineType} ${e.tailColor}`},"&-pending":{[`${t}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${t}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${s(e.dotBorderWidth)} ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:r(e.itemHeadSize).div(2).equal(),insetInlineStart:r(e.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.lineWidth).equal(),marginInlineStart:r(e.margin).add(e.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${t}-item-tail`]:{display:"none"},[`> ${t}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}}},[`&${t}-alternate,
        &${t}-right,
        &${t}-label`]:{[`${t}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:r(e.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:r(e.tailWidth).div(2).equal()}},"&-left":{[`${t}-item-content`]:{insetInlineStart:`calc(50% - ${s(e.marginXXS)})`,width:`calc(50% - ${s(e.marginSM)})`,textAlign:"start"}},"&-right":{[`${t}-item-content`]:{width:`calc(50% - ${s(e.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${t}-right`]:{[`${t}-item-right`]:{[`${t}-item-tail,
            ${t}-item-head,
            ${t}-item-head-custom`]:{insetInlineStart:`calc(100% - ${s(r(r(e.itemHeadSize).add(e.tailWidth)).div(2).equal())})`},[`${t}-item-content`]:{width:`calc(100% - ${s(r(e.itemHeadSize).add(e.marginXS).equal())})`}}},[`&${t}-pending
        ${t}-item-last
        ${t}-item-tail`]:{display:"block",height:`calc(100% - ${s(e.margin)})`,borderInlineStart:`${s(e.tailWidth)} dotted ${e.tailColor}`},[`&${t}-reverse
        ${t}-item-last
        ${t}-item-tail`]:{display:"none"},[`&${t}-reverse ${t}-item-pending`]:{[`${t}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${s(e.margin)})`,borderInlineStart:`${s(e.tailWidth)} dotted ${e.tailColor}`},[`${t}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}},[`&${t}-label`]:{[`${t}-item-label`]:{position:"absolute",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.tailWidth).equal(),width:`calc(50% - ${s(e.marginSM)})`,textAlign:"end"},[`${t}-item-right`]:{[`${t}-item-label`]:{insetInlineStart:`calc(50% + ${s(e.marginSM)})`,width:`calc(50% - ${s(e.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${t}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},le=e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25}),ne=R("Timeline",e=>{const t=X(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[ae(t)]},le);var se=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r};const oe=e=>{var{prefixCls:t,className:r,color:i="blue",dot:a,pending:u=!1,position:S,label:m,children:f}=e,y=se(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:p}=o.useContext(N),n=p("timeline",t),$=b(`${n}-item`,{[`${n}-item-pending`]:u},r),g=/blue|red|green|gray/.test(i||"")?void 0:i,d=b(`${n}-item-head`,{[`${n}-item-head-custom`]:!!a,[`${n}-item-head-${i}`]:!g});return o.createElement("li",Object.assign({},y,{className:$}),m&&o.createElement("div",{className:`${n}-item-label`},m),o.createElement("div",{className:`${n}-item-tail`}),o.createElement("div",{className:d,style:{borderColor:g,color:g}},a),o.createElement("div",{className:`${n}-item-content`},f))},z=oe;var I=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r};const ce=e=>{var{prefixCls:t,className:r,pending:i=!1,children:a,items:u,rootClassName:S,reverse:m=!1,direction:f,hashId:y,pendingDot:p,mode:n=""}=e,$=I(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const g=(l,h)=>n==="alternate"?l==="right"?`${t}-item-right`:l==="left"?`${t}-item-left`:h%2===0?`${t}-item-left`:`${t}-item-right`:n==="left"?`${t}-item-left`:n==="right"?`${t}-item-right`:l==="right"?`${t}-item-right`:"",d=M(u||[]),C=typeof i=="boolean"?null:i;i&&d.push({pending:!!i,dot:p||o.createElement(V,null),children:C}),m&&d.reverse();const x=d.length,O=`${t}-item-last`,T=d.filter(l=>!!l).map((l,h)=>{var v;const W=h===x-2?O:"",_=h===x-1?O:"",{className:A}=l,L=I(l,["className"]);return o.createElement(z,Object.assign({},L,{className:b([A,!m&&i?W:_,g((v=l==null?void 0:l.position)!==null&&v!==void 0?v:"",h)]),key:(l==null?void 0:l.key)||h}))}),j=d.some(l=>!!(l!=null&&l.label)),q=b(t,{[`${t}-pending`]:!!i,[`${t}-reverse`]:!!m,[`${t}-${n}`]:!!n&&!j,[`${t}-label`]:j,[`${t}-rtl`]:f==="rtl"},r,S,y);return o.createElement("ul",Object.assign({},$,{className:q}),T)},de=ce;function me(e,t){return e&&Array.isArray(e)?e:K(t).map(r=>{var i,a;return Object.assign({children:(a=(i=r==null?void 0:r.props)===null||i===void 0?void 0:i.children)!==null&&a!==void 0?a:""},r.props)})}var ue=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(r[i[a]]=e[i[a]]);return r};const w=e=>{const{getPrefixCls:t,direction:r,timeline:i}=o.useContext(N),{prefixCls:a,children:u,items:S,className:m,style:f}=e,y=ue(e,["prefixCls","children","items","className","style"]),p=t("timeline",a),n=Q(p),[$,g,d]=ne(p,n),C=me(S,u);return $(o.createElement(de,Object.assign({},y,{className:b(i==null?void 0:i.className,m,d,n),style:Object.assign(Object.assign({},i==null?void 0:i.style),f),prefixCls:p,direction:r,items:C,hashId:g})))};w.Item=z;const pe=w;var E=(e=>(e.CreatePaper="CreatePaper",e))(E||{});async function ge(){return await B.getItem("history-snapshot")||[]}async function he(){const t=(await Z()).map(r=>({action:E.CreatePaper,payload:{key:r.key},ctime:r.ctime}));B.setItem("history-snapshot",t)}function fe({paperKey:e}){var r,i;const t=H({queryKey:["paper",e],queryFn:()=>k(e)});return c.jsxs("span",{children:[c.jsxs("strong",{children:[ie((r=t.data)==null?void 0:r.ctime).format(te)," 创建文章"]}),c.jsx("br",{}),(i=t.data)==null?void 0:i.title]})}const P="history-snapshot";function Ie(){var a;const{message:e}=G.useApp(),t=F(),r=H({queryKey:[P],queryFn:()=>ge()}),i=(a=r.data)==null?void 0:a.map(u=>({children:c.jsx(fe,{paperKey:u.payload.key})}));return c.jsx(J,{mode:"custom",children:c.jsxs(ee,{className:"p-5",children:[c.jsx(U,{size:"small",children:c.jsx(Y,{onClick:()=>{he(),t.invalidateQueries({queryKey:[P]}),r.refetch(),e.success("操作成功")},type:"text",size:"small",icon:c.jsx(re,{}),children:"重新加载"})}),c.jsx(pe,{pending:r.isLoading&&"Loading...",mode:"left",items:i,className:"my-5 mx-3"})]})})}export{Ie as default};
